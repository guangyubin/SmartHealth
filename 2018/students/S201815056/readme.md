一、心电信号
（1）心电信号的特性
人体心电信号是非常微弱的生理低频电信号，通常最大的幅值不超过5mV，信号频率在0．05～100Hz之间。心电信号是通过安装在人体皮肤表面的电极来拾取的。由于电极和皮肤组织之间会发生极化现象，会对心电信号产生严重的干扰。加之人体是一个复杂的生命系统，存在各种各样的其他生理电信号对心电信号产生干扰。同时由于我们处在一个电磁包围的环境中，人体就像一根会移动的天线，从而会对心电信号产生50Hz左右的干扰信号。心电信号具有微弱、低频、高阻抗等特性，极容易受到干扰，所以分析干扰的来源，针对不同干扰采取相应的滤除措施，是数据采集重点考虑的一个问题。常见干扰有如下几种：①工频干扰②基线漂移③肌电干扰 
心电信号具有以下几个特点：    
  ·信号极其微弱，一般只有0.05～4mV，典型值为1mV；
  ·频率范围较低，频率范围为0.1～35Hz，主要集中在5～20Hz；
  ·存在不稳定性。人体内部各器官问的相互影响以及各人的心脏位置、呼吸、年龄、是否经常锻炼等因素，都会使心电信号发生相应变化；
  ·干扰噪声很强。对心电信号进行测量时，必然要与外界联系，但由于其自身的信号非常微弱，因此，各种干扰噪声非常容易影响测量。
其噪声可能来自工频(50Hz)干扰、电极接触噪点、运动伪迹、肌电噪声、呼吸引起的基线漂移和心电幅度变化以及其他电子设备的机器噪声等诸多方面。
（2）心电信号的选择本次实验所采用的心电信号来自MIT-BIH库（心律失常数据库，关于这个库的介绍可以参考：点击打开链接），库中有48组失常的心电信号，要在其中找出符合实验要求的心电信号（即含有肌电干扰、工频干扰和基线漂移）。（3）正常心电信号波形
https://github.com/guangyubin/SmartHealth/blob/master/2018/students/S201815056/MATLAB%20JPG/ecg.jpg
                                           图1   正常心电信号波形

图1是正常心电信号在一个周期内的波形，由P波、QRS波群和T波组成。
P波是由心房的去极化产生的，其波形比较小，形状有些圆，幅度约为0.25mV，持续时间为0.08~0.11s。窦房结去极化发生在心房肌细胞去极化之前，因而在时间上要先于P波，只是窦房结处于心脏内部，其电活动在体表难以采集。
P-R间期是指P波起点和QRS波群起点所跨越的时间，是窦房结产生的兴奋，经过右心房、左心房、房室交接区、房室束、左右束支之后，传到到心室所需要的时间。在正常的体表心电图中，P-R间期的值为0.12~0.2s，其中大部分时间是兴奋在房室交界区内传导所需要的时间。P-R间期也称为房室传导时间。
P-R段是指P波终点和QRS波群起点之间所跨越的时间。在正常的体表心电图中，P-R段的心电信号电位值都是接近基线水平的很小点位。在P-R段期间，左右心房同时兴奋，因而两者产生的综合电场对体表心电图的影响较小。另外，此时的兴奋还处于房室交界区和房室束特殊传导系统中，没有到达心室，因而没有产生较大波动的体表心电图信号。
QRS波群是左右心室肌细胞一次发生去极化所产生的膜外负电位在体表的反应。QRS波群的持续时间为0.06~0.1s。由于心室肌细胞在兴奋过程中的综合电场向量多次发生改变，因而形成了体表心电图中大小和方向多次发生变化的心电信号，其中QRS波群中第一个向下的波为Q波，第一个向上的波为R波，R波后面的为S波。
S-T段是指QRS波群终点和T波起点之间所跨越的时间。S-T段期间，左右心室的肌细胞都处于兴奋期间，因而两者形成的综合电场向量在体表心电图中的贡献非常小，导致S-T段心电信号处于大约基线的水平。
T波由心室肌细胞的复极化产生，其幅度为0.1~0.8mV，持续时间为0.05~0.25s。由于复极化差异的存在，T波的方向和QRS波群主波的方向一致。在R波向上的情况下，T波的幅度一般都超过R波幅度的1/10。Q-T间期是指QRS波群起点和T波终点所跨越的时间段，代表心室肌细胞开始去极化到结束复极化所需要的时间，与心率呈负相关。
二、滤波器的选择
1.肌电干扰的滤除—低通滤波器  
通常来说，肌电信号的频率为20~5000HZ，其主要成分的频率与肌肉的类型有关，一般在30~300HZ，而心电信号的频率主要集中在5~20HZ，所以选择低通滤波器来滤除肌电干扰。
巴特沃斯滤波器的特点是通频带内的频率响应曲线最为平坦，没有起伏，而在阻频带则逐渐下降为零。巴特沃斯滤波器的振幅对角频率单调下降，并且滤波器的阶数越高，在阻频带幅度衰减速度越快，其他滤波器高阶的振幅对角频率图和低阶数的振幅对角频率有不同的形状。
2.工频干扰的抑制—带陷滤波器
工频干由于供电网络无所不在，因此50Hz的工频干扰是最普遍的，也是心电信号的主要干扰来源。50HZ陷波器的软件设计方法多种多样，常见方法有小波变换滤波、自适应滤波、模板匹配滤波等，但都需要手工计算获得滤波器的参数，运算比较复杂。
滤波器设计中，使用IIR滤波器，可使阶数降低，运算量减少，但破坏了相位特性；使用FIR滤波器既能得到很好的滤波效果，是波形失真达到最下，而且，FIR滤波器可以做成线性相位特性，这正好是心电信号滤波所需要的。
利用MATLAB设计FIR滤波器的方法有窗函数法、频率抽样法和切比雪夫逼近法等，本次课设采用窗函数法设计50HZ陷波滤波器。窗函数方法的基本思想是：首先根据要求选择一个适当的理想低通滤波器，因为其脉冲响应是非因果且无限长的，用最优化窗结构窗函数来截取它的脉冲响应，从而得到线性相位和因果的FIR滤波器。Kaiser窗是接近最优化窗结构的窗函数，它可以根据不同的参数调整滤波器的各项指标，因此采用Kaiser窗函数进行滤波器设计扰的抑制—带陷滤波器
3.基线漂移的纠正—零相移滤波器
零相移滤波器是指一个信号序列经过该滤波器滤波后相位不发生变化，即该滤波器系统函数的相位响应为零。显然，对于因果系统来说是不可能实现零相移的，在事先无法知道信号相位谱的情况下，实现零相移是不可能的。零相移只能是对非因果系统来说的。具体而言，零相移滤波器使用了当前信号点前面和后面的信号点所包含的信息，从本质上说就是使用了“未来的信息”来消除相位失真。
